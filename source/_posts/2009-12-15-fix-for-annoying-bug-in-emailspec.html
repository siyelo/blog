---
layout: post
title: "Fix for annoying bug in EmailSpec"
date: 2009-12-15 13:33:00
comments: true
categories:
author: 
---


    <p>EmailSpec with Cucumber is a great combo. How else could you get such nice BDD syntax such as;</p>
<p><div class="data type-cucumber">
      <table class="lines" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <pre class="line_numbers"><span id="L1">1</span>
<span id="L2">2</span>
<span id="L3">3</span>
<span id="L4">4</span>
<span id="L5">5</span>
<span id="L6">6</span>
<span id="L7">7</span>
<span id="L8">8</span>
<span id="L9">9</span>
<span id="L10">10</span>
</pre>
          </td>
          <td width="100%">
                <div class="highlight"><pre /><div class="line" id="LC1"><span class="k">Scenario Outline:</span><span class="nf"> Register new user </span></div><div class="line" id="LC2"><span class="k">Given </span><span class="nf">I am on the signup page </span></div><div class="line" id="LC3"><span class="k">And </span><span class="nf">I fill in &quot;</span><span class="s">Email</span><span class="nf">&quot; with &quot;&quot; </span></div><div class="line" id="LC4"><span class="k">And </span><span class="nf">I fill in &quot;</span><span class="s">Password</span><span class="nf">&quot; with &quot;&quot; </span></div><div class="line" id="LC5"><span class="k">And </span><span class="nf">I press &quot;</span><span class="s">Create My Account</span><span class="nf">&quot; </span></div><div class="line" id="LC6"><span class="k">Then </span><span class="nf">I should </span></div><div class="line" id="LC7"><span class="k">And </span><span class="nf">I should receive an email </span></div><div class="line" id="LC8"><span class="k">When </span><span class="nf">I open the email </span></div><div class="line" id="LC9"><span class="k">Then </span><span class="nf">I should see &quot;</span><span class="s">Please activate your new account</span><span class="nf">&quot; in the subject </span></div><div class="line" id="LC10"><span class="k">When </span><span class="nf">I click the first link in the email </span></div></pre></div>
          </td>
        </tr>
      </table>
  </div></p>
<p>And if you happen to be using EmailSpec 0.3.5 and you're getting an error like this, I may have a solution for you; <p /> <div class="data type-text">
      <table class="lines" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <pre class="line_numbers"><span id="L1">1</span>
<span id="L2">2</span>
<span id="L3">3</span>
<span id="L4">4</span>
<span id="L5">5</span>
<span id="L6">6</span>
<span id="L7">7</span>
<span id="L8">8</span>
<span id="L9">9</span>
</pre>
          </td>
          <td width="100%">
                <div class="highlight"><pre /><div class="line" id="LC1">You have a nil object when you didn&#039;t expect it! </div><div class="line" id="LC2">You might have expected an instance of Array. </div><div class="line" id="LC3">The error occurred while evaluating nil.include? (NoMethodError) </div><div class="line" id="LC4">/Users/glennroberts/.gem/ruby/1.8/gems/glennr-email_spec-0.3.5/lib/email_spec/deliveries.rb:45:in `mailbox_for&#039; </div><div class="line" id="LC5">/Users/glennroberts/.gem/ruby/1.8/gems/glennr-email_spec-0.3.5/lib/email_spec/deliveries.rb:45:in `select&#039; </div><div class="line" id="LC6">/Users/glennroberts/.gem/ruby/1.8/gems/glennr-email_spec-0.3.5/lib/email_spec/deliveries.rb:45:in `mailbox_for&#039; </div><div class="line" id="LC7">/Users/glennroberts/.gem/ruby/1.8/gems/glennr-email_spec-0.3.5/lib/email_spec/helpers.rb:138:in `mailbox_for&#039; </div><div class="line" id="LC8">/Users/glennroberts/.gem/ruby/1.8/gems/glennr-email_spec-0.3.5/lib/email_spec/helpers.rb:48:in `unread_emails_for&#039; </div><div class="line" id="LC9">./features/step_definitions/email_steps.rb:52 </div></pre></div>
          </td>
        </tr>
      </table>
  </div><em><br /></em> <br />I fixed the offending bug - grab the code either at Gemcutter <p /> <div class="data type-text">
      <table class="lines" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <pre class="line_numbers"><span id="L1">1</span>
</pre>
          </td>
          <td width="100%">
                <div class="highlight"><pre /><div class="line" id="LC1">gem install glennr-email-spec </div></pre></div>
          </td>
        </tr>
      </table>
  </div><em><br /></em> <br />or via GitHub <p /> <em><a href="http://github.com/glennr/email-spec">http://github.com/glennr/email-spec</a> </em><p /> If you're reading this Mr Mabey, please include in the next email-spec patch :-)</p>
  
