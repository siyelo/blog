
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Siyelo</title>
  <meta name="author" content="Siyelo">

  
  <meta name="description" content="03 Jul 2012 Vim Tips - Part II &#8211;> Comments &#8211;> &#8211;> This week we&#8217;ll share few more userful Vim tips that we&#8217;ve learned &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.siyelo.com/page/6/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Siyelo" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6353020-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body id="blog"   >
  <header role="banner"><header id="header">
  <div class="wrapper">
    <h1 class="left" id="logo_alt">
      <a href="http://www.siyelo.com/"><img title="Siyelo" src="http://siyelo.com/images/logo_siyelo.png" alt="Siyelo logo"></a>
    </h1>
    <ul class="right horizontal" id="contact">
      <li><a href="mailto:info@siyelo.com" title="Email us - we want to hear from you">info@siyelo.com</a></li>
      <li>
      <p>+27 21 461 2050</p>
      </li>
    </ul>
    <nav class="right" id="main_nav">
    <ul class="horizontal">
      <li><a href="http://www.siyelo.com">Home</a></li>
      <li><a href="http://www.siyelo.com/services">Services</a></li>
      <li><a href="http://www.siyelo.com/projects">Projects</a></li>
      <li><a href="http://www.siyelo.com/team">Team</a></li>
      <li><a href="/" class="active">Blog</a></li>
    </ul>
    </nav>
  </div>
</header>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.siyelo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav> -->
  <div class="wrapper multiclouds">
  <div id="articles">
    
    
    
      <article>
        
  <header>
    















<section><time class="timestamp" datetime="2012-07-03T16:39:23+02:00" pubdate data-updated="true">
    <span class='day'> 03</span>
    <span class='month'> Jul</span>
    <span class='year'> 2012</span>
  </time></section>
    
      <h1 class="entry-title"><a href="/vim-tips-part-ii">Vim Tips - Part II</a></h1>
    
    <!--  -->
    <!--   <p class="meta"> &#8211;>
    <!--      -->
    <!--      | <a href="/vim-tips-part-ii#disqus_thread">Comments</a> &#8211;>
    <!--      -->
    <!--   </p> &#8211;>
    <!--  -->
  </header>


  <div class="body"><div class="inner"><p>This week we&#8217;ll share few more userful Vim tips that we&#8217;ve learned recently, most of them from the <a href="http://pragprog.com/book/dnvim/practical-vim">Practical Vim</a> book. You can also read the first part in this series <a href="http://blog.siyelo.com/vim-tips-part-i">Vim Tips - Part I</a> at our blog.</p>

<h2>1. Replace in multiple files</h2>

<p>To search &amp; replace in multiple files, we need to create list of files in which we&#8217;ll execute a command. We do that by using the <strong>:args</strong> command. For example, lets load all javascript files that start with the &#8220;hrt&#8221; string:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span>args app<span class="sr">/assets/</span>javascripts/hrt*.<span class="nb">js</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can see which files are loaded in the arguments list by running only the <strong>:args</strong> command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span>args
</span></code></pre></td></tr></table></div></figure>


<p>Having the arguments list prepared, we can execute search &amp; replace with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span><span class="k">argdo</span> %<span class="k">s</span><span class="sr">/Hrt/</span>Hrt2/<span class="k">g</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once changes have been made in the files, we can save all the files in arguments list with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span><span class="k">argdo</span> <span class="k">update</span>
</span></code></pre></td></tr></table></div></figure>


<h2>2. Search and replace in multiple files</h2>

<p>Previous tip works OK if we know the files where we want to run the replace command. Most common need is to search for a string in files, and then run the replace command only in those files. We can do that by using <strong>vimgrep</strong> command to find a pattern in files .<strong>vimgrep</strong> command creates quicklist with files matching the pattern which list we can see by opening it with <strong>:copen</strong> command. If we want quicklist to be useful, we need to convert it to arguments list by using the <strong>:Qargs</strong> mapping which we have in our vimrc file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>command<span class="p">!</span> <span class="p">-</span>nargs<span class="p">=</span><span class="m">0</span> <span class="p">-</span><span class="k">bar</span> Qargs execute <span class="s1">&#39;args&#39;</span> QuickfixFilenames<span class="p">()</span>
</span><span class='line'><span class="c">&quot; populate the argument list with each of the files named in the quickfix list</span>
</span><span class='line'><span class="k">function</span><span class="p">!</span> QuickfixFilenames<span class="p">()</span>
</span><span class='line'>  <span class="k">let</span> buffer_numbers <span class="p">=</span> {}
</span><span class='line'>  <span class="k">for</span> quickfix_item <span class="k">in</span> getqflist<span class="p">()</span>
</span><span class='line'>    <span class="k">let</span> buffer_numbers[quickfix_item[<span class="s1">&#39;bufnr&#39;</span>]] <span class="p">=</span> bufname<span class="p">(</span>quickfix_item[<span class="s1">&#39;bufnr&#39;</span>]<span class="p">)</span>
</span><span class='line'>  <span class="k">endfor</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">join</span><span class="p">(</span>map<span class="p">(</span>values<span class="p">(</span>buffer_numbers<span class="p">),</span> <span class="s1">&#39;fnameescape(v:val)&#39;</span><span class="p">))</span>
</span><span class='line'><span class="k">endfunction</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, here&#8217;s an example of what needs to be run to do search &amp; replace in files:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span><span class="k">vimgrep</span> <span class="sr">/CurrencyNumberHelper/</span> app<span class="sr">/models/</span>*.rb
</span><span class='line'><span class="p">:</span>Qargs
</span><span class='line'><span class="p">:</span><span class="k">argdo</span> %<span class="k">s</span><span class="sr">/CurrencyNumberHelper/</span>CurrencyHelper/<span class="k">g</span>
</span><span class='line'><span class="p">:</span><span class="k">argdo</span> <span class="k">update</span>
</span></code></pre></td></tr></table></div></figure>


<h2>3. Edit already recorded macro</h2>

<p>While recording a macro it&#8217;s easy to do mistakes. And when that happens, it&#8217;s easier to edit the already recorded macro than to re-record it. Lets say we have recorded new macro in register <strong>a</strong>. We can print the content of the macro in the current buffer using <strong>:put a</strong> and then edit the macro in Vim. Once macro is changed, we can select it and then yank it to register a with <strong>&#8220;ay</strong>. Then we are ready to execute the new macro from register a with <strong>@a</strong>.</p>

<h2>4. Execute macro in multiple files</h2>

<p>We have already recorded a macro and we want to run it in few files. First we build arguments list with the files, for example let&#8217;s load all models from a Rails app:
:args app/models/*.rb Then we run the macro (that is recorded in register a) with:
:argdo normal @aIn the end we save all the buffers with:
:argdo update</p>

<h2>5. Delete commands</h2>

<p>We can run the following command in <strong>Insert mode</strong>, <strong>Vim Command Line mode</strong> or <strong>Shell Command Line</strong>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">h</span><span class="p">&gt;</span> <span class="c">&quot; delete back one character (backspace)</span>
</span><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span> <span class="c">&quot; delete back one word</span>
</span><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">u</span><span class="p">&gt;</span> <span class="c">&quot; delete back to start of line</span>
</span></code></pre></td></tr></table></div></figure>


<h2>6. Vi mode on command line</h2>

<p>Bash shell provides two modes for command line editing - <strong>emacs</strong> and <strong>vi</strong>. Emacs editing mode is the default one, and we can change it to vi mode using:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">set</span> <span class="p">-</span><span class="k">o</span> <span class="k">vi</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then while on command line, we can press <strong>ESC</strong> to go to vi editing mode and use Vim&#8217;s single line editing capabilities. While in normal Vim mode on command line, we can press <strong>v</strong> that will popup editor where we can edit and save buffer that will be executed on command line.</p>

<p>To go back to emacs mode, we need to type:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">set</span> <span class="p">-</span><span class="k">o</span> emacs
</span></code></pre></td></tr></table></div></figure>


<p>If you want to learn more about which Vim commands you can run in bash shell vi mode, here&#8217;s <a href="http://www.catonmat.net/download/bash-vi-editing-mode-cheat-sheet.txt">cheatsheet</a> for that.</p>
</div></div>
  
  


      </article>
    
    
      <article>
        
  <header>
    















<section><time class="timestamp" datetime="2012-06-27T09:50:00+02:00" pubdate data-updated="true">
    <span class='day'> 27</span>
    <span class='month'> Jun</span>
    <span class='year'> 2012</span>
  </time></section>
    
      <h1 class="entry-title"><a href="/vim-tips-part-i">Vim Tips - Part I</a></h1>
    
    <!--  -->
    <!--   <p class="meta"> &#8211;>
    <!--      -->
    <!--      | <a href="/vim-tips-part-i#disqus_thread">Comments</a> &#8211;>
    <!--      -->
    <!--   </p> &#8211;>
    <!--  -->
  </header>


  <div class="body"><div class="inner"><p>At Siyelo all developers exclusively use Vim editor for coding. In this two-parts series we&#8217;ll share few Vim tips that we find useful. Most of the tips we&#8217;ve learned from the great <a href="http://pragprog.com/book/dnvim/practical-vim">Practical Vim</a> book by Drew Neil.</p>

<h3>1. Repeat the last Ex command</h3>

<p>In Vim there are 3 command line mode prompts:</p>

<ul>
<li>Ex command prompt: <strong>:something</strong></li>
<li>Search prompt: <strong>/something</strong></li>
<li>Expression prompt (from insert mode type <b><C-r>=</b>): <strong>=1+1</strong></li>
</ul>


<p>Let say we run a spec from the Ex command prompt like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:!</span>rspec spec<span class="sr">/models/</span>code_spec.rb
</span></code></pre></td></tr></table></div></figure>


<p>We can repeat the last Ex command by typing <strong>@:</strong> from normal mode.</p>

<h3>2. Repeat the last substitute command</h3>

<p>If substitute command is run, like for example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span><span class="k">s</span><span class="sr">/current_user/</span>user/<span class="k">g</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can repeat it with <strong>:s</strong> or <strong>&amp;</strong> which is synonym for <strong>:s</strong>. Note that flags used at the substitute command are not remembered, and to fix that <strong>:&amp;&amp;</strong> should be used. It&#8217;s handy having the following mappings in the vimrc file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; make &amp; trigger :&amp;&amp; so it preserves flags</span>
</span><span class='line'><span class="nb">nnoremap</span> &amp; :&amp;&amp;<span class="p">&lt;</span>Enter<span class="p">&gt;</span>
</span><span class='line'>xnoremap &amp; :&amp;&amp;<span class="p">&lt;</span>Enter<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3. Sort properties in CSS</h3>

<p>Some developers order the CSS properties by grouping them by width-height, margin-padding, other use to order them in alphabetical order. If you belong to the second group, this tip will help not search for the place where to enter the new properties.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>h4 {
</span><span class='line'>  font<span class="p">-</span>size: <span class="m">11</span>px;
</span><span class='line'>  margin: <span class="m">15</span>px;
</span><span class='line'>  <span class="nb">background</span>: <span class="k">red</span>;
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>Just append them at the end, select the lines and in visual mode type <strong>:sort</strong>, or from normal mode select everything inside {} with <strong>vi{</strong> and then <strong>:sort</strong>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>h4 {
</span><span class='line'>  <span class="nb">background</span>: <span class="k">red</span>;
</span><span class='line'>  font<span class="p">-</span>size: <span class="m">11</span>px;
</span><span class='line'>  margin: <span class="m">15</span>px;
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<h3>4. Select texts</h3>

<p>Select the original yanked text with <strong>gv</strong> or select the last pasted text with <strong>gb</strong> (custom mapping). <strong>gb</strong> is really usesful when doing extract method refactoring with cut-paste text and then fix the identation with <strong>gb&lt;</strong>. For <strong>gb</strong> to work, the following mapping need to be defined in the vimrc file.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; select last paste in visual mode</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>expr<span class="p">&gt;</span> gb <span class="s1">&#39;`[&#39;</span> . strpart<span class="p">(</span>getregtype<span class="p">(),</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> . <span class="s1">&#39;`]&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>5. Paste from register without leaving insert mode <C-r>{register}</h3>

<p>While in insert mode, yanked text can be pasted without leaving the insert mode with <strong><C-r>0</strong>. If yanked text contains new line characters, <strong><C-r><C-p>0</strong> will take care of fixing the indentation.</p>

<h3>6. Run normal mode commands across a range</h3>

<p>Say we want to append ; at the end of the following lines:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>var element <span class="p">=</span> $<span class="p">(</span>this<span class="p">)</span>
</span><span class='line'>var tabName <span class="p">=</span> element.data<span class="p">(</span><span class="s1">&#39;tab&#39;</span><span class="p">)</span>
</span><span class='line'>var <span class="nb">report</span>  <span class="p">=</span> element.data<span class="p">(</span><span class="s1">&#39;report&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can visually select the 3 lines and type <strong>:normal A;</strong> or we can just select all lines in the file with <strong>%</strong> and execute the same command <strong>:%normal A;</strong>.</p>

<p>Next week we&#8217;re coming with few more tips to improve your vimfu.</p>
</div></div>
  
  


      </article>
    
    
      <article>
        
  <header>
    















<section><time class="timestamp" datetime="2012-06-21T18:10:35+02:00" pubdate data-updated="true">
    <span class='day'> 21</span>
    <span class='month'> Jun</span>
    <span class='year'> 2012</span>
  </time></section>
    
      <h1 class="entry-title"><a href="/rails-3-upgrade-process-the-road-from-2-3-14-to-3-2-6">Rails 3 Upgrade Process (the Road From 2.3.14 to 3.2.6)</a></h1>
    
    <!--  -->
    <!--   <p class="meta"> &#8211;>
    <!--      -->
    <!--      | <a href="/rails-3-upgrade-process-the-road-from-2-3-14-to-3-2-6#disqus_thread">Comments</a> &#8211;>
    <!--      -->
    <!--   </p> &#8211;>
    <!--  -->
  </header>


  <div class="body"><div class="inner"><p>We&#8217;ve just upgraded an application with about 20K LOC (Lines Of Code) from Rails 2.3.14 to Rails 3.2.6 and Ruby 1.8.7 to Ruby 1.9.3. Here we&#8217;ll share some details about the experience and the process we took for the upgrade. Before the upgrade, it&#8217;s advisable to migrate to the latest Rails 2.3 version (2.3.14).</p>

<h3>Versions running out of support&#8230;</h3>

<p>Why upgrade? Ruby 1.8.7 is slowly <a href="http://www.ruby-lang.org/en/news/2011/10/06/plans-for-1-8-7/">running out of support</a> and Ruby on Rails 2.3.x is already <a href="https://groups.google.com/forum/#!topic/rubyonrails-security/CdoMUVpsRmQ/discussion">out of maintenance and out of security support</a>. If wondering which Ruby on Rails version are supported at the moment, it&#8217;s 3.2 for bugfixes and 3.1 for security fixes (see this <a href="http://groups.google.com/group/rubyonrails-core/browse_thread/thread/30ff7f618a6428f3/a767ba1bbf526fde?q=#50a39e4694704f14">thread discussion</a> on rails-core mailing list). </p>

<h3>How to approach the upgrade&#8230;</h3>

<p>There are several schools of thought regarding this matter:</p>

<ul>
<li>Upgrade both your ruby version to 1.9.1+ and your stack to Rails stack simultaniously.</li>
<li>Upgrade your Rails stack and then upgrade your Ruby version</li>
<li>Upgrade your Ruby version and then your Rails stack</li>
</ul>


<p>We went with the first.</p>

<p>This was because although we have a relatively large application, we found that most of the gems being used were easily replaced and had no conflicts with Rails 3.x.</p>

<h3>Upgrade now&#8230;</h3>

<p>The upgrade process to Rails 3.x is rather straight forward as most of the gems have already been ported to support Rails 3.x and many and most have documentated how to do the change. In the rare case that one of your gems does not support rails 3, they are easily replaced.</p>

<p>Here is how we upgraded:</p>

<p>Start by installing the <a href="https://github.com/rails/rails_upgrade">rails_upgrade</a> plugin:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ruby script/plugin install git://github.com/rails/rails_upgrade.git
</span></code></pre></td></tr></table></div></figure>


<p>Then run the rake task that does a check for required upgrades:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake rails:upgrade:check
</span></code></pre></td></tr></table></div></figure>


<p>The output is rather descriptive. It hightlights all the changes required and even links to blog posts for those of you who would like additional information on how to approach the changes.</p>

<p>Run the backup task. This backs up all of your routes, environments, application, etc.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake rails:upgrade:backup
</span></code></pre></td></tr></table></div></figure>


<p>There is a rake task to upgrade all of your routes to the new DSL. We found that we needed to make minor changes after this task was run.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake rails:upgrade:routes
</span></code></pre></td></tr></table></div></figure>


<p>Yet another rake task for generating a Gemfile from config.gem directives.</p>

<p>In Rails 3, bundler handles all your gems and dependencies (Fortunately our app was already using bundler). If yours isn&#8217;t the <a href="https://github.com/rails/rails_upgrade">rails_upgrade</a>  plugin is nice enough to do this for you!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake rails:upgrade:gems
</span></code></pre></td></tr></table></div></figure>


<p>Now it&#8217;s just a matter of upgrading the Rails version ensuring that you have not locked any of the other gems at a version incompatible with your upgrade. Then let bundler do it&#8217;s thing:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bundle install
</span></code></pre></td></tr></table></div></figure>


<p>Then run all the generators for gems like rspec, cucumber and setup spork, guard.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails g rspec:install --spork
</span><span class='line'>rails g cucumber:install --rspec --capybara --spork
</span><span class='line'>bundle <span class="nb">exec </span>guard init
</span><span class='line'>bundle <span class="nb">exec </span>guard init spork
</span></code></pre></td></tr></table></div></figure>


<p>If using cucumber and it&#8217;s old web steps, you&#8217;ll need to add <a href="https://github.com/cucumber/cucumber-rails-training-wheels">cucumber-rails-training-wheels</a>  to the Gemfile. It&#8217;s also good to setup the <a href="http://guides.rubyonrails.org/asset_pipeline.html">assets pipeline</a>  in order to get the full benefits from newest version of Rails.</p>

<p>From here we went about fixing our specs (aren&#8217;t they just fabulous?). We feel this is an important step as it will expose problems and give you deprecation warnings.</p>

<p>We didn&#8217;t go as far as to fix every spec and cuke. Just to the point where we felt comfortable upgrading again!</p>

<p>So we generated a new Rails 3.2.6 application in another folder and carefuly moved across the Rails configuration files (production.rb, development.rb, Rakefile, etc).</p>

<p>After some more bug and deprecation warning fixes we have a stable app once again! :)</p>

<p>Now all that&#8217;s left to do is clean up the old backup files, old rails scripts/* files and your vendor/plugins and you&#8217;re done!</p>

<p>Happy upgrades!</p>
</div></div>
  
  


      </article>
    
    
      <article>
        
  <header>
    















<section><time class="timestamp" datetime="2012-05-11T16:07:00+02:00" pubdate data-updated="true">
    <span class='day'> 11</span>
    <span class='month'> May</span>
    <span class='year'> 2012</span>
  </time></section>
    
      <h1 class="entry-title"><a href="/were-hiring-social-media-marketing-intern">WE’RE HIRING! – SOCIAL MEDIA MARKETING INTERN</a></h1>
    
    <!--  -->
    <!--   <p class="meta"> &#8211;>
    <!--      -->
    <!--      | <a href="/were-hiring-social-media-marketing-intern#disqus_thread">Comments</a> &#8211;>
    <!--      -->
    <!--   </p> &#8211;>
    <!--  -->
  </header>


  <div class="body"><div class="inner"><p>Siyelo is growing fast and we&#8217;re looking for a bright, hardworking individual to join our team as a Social Media Intern!</p>

<p>–</p>

<p><strong>Location</strong>: Cape Town, South Africa</p>

<p><strong>Start date</strong>: June 2012</p>

<p><strong>Duration</strong>: 8 to 12 weeks</p>

<p><strong>Funding</strong>: Expenses and reasonable honorarium</p>

<p><strong>Internship Description:</strong></p>

<p>Siyelo is a web design and development agency, consulting to a wide variety of clients and industries. You will work alongside our team to create engaging social content that inspires and motivates a passionate tech community. A successful intern will be able to learn fast, thrive on juggling a lot of tasks, enjoy tracking details; and has the ability to keep cool under deadlines.</p>

<p><strong>Skills &amp; Experience Required:</strong></p>

<ul>
<li><p>Energetic, independent, and detail-oriented.</p></li>
<li><p>Strong written and oral communication skills - in English</p></li>
<li><p>Available at least 16 to 24 hours a week.</p></li>
<li><p>Studying for or recently graduated with a degree in business, communication, social sciences, with good grades</p></li>
<li><p>Highly sociable and witty</p></li>
<li><p>Knowledge of HTML is a plus</p></li>
</ul>


<p><strong>Sample projects you will work on:</strong></p>

<ul>
<li><p>Support to all Marketing activities</p></li>
<li><p>Manage integrated social media campaigns.</p></li>
<li><p>Social strategy and overviews</p></li>
<li><p>Evaluate positioning and activity of competitors.</p></li>
<li><p>Take charge of managing posting and profile upkeep.</p></li>
<li><p>Identify opportunities for increased social interaction.</p></li>
<li><p>Research new social techniques, platforms and trends.</p></li>
<li><p>Testing new products</p></li>
</ul>


<p><strong>Benefits for Intern:</strong></p>

<ul>
<li><p>Siyelo offers an international, fast-paced and dynamic environment in hot web techologies.</p></li>
<li><p>A great office in central Cape Town. Open, creative and vibrant.</p></li>
<li><p>Ping-pong, putt-putt, and Playstation3.</p></li>
<li><p>Other fun things not beginning with the letter &#8216;P&#8217;.</p></li>
<li><p>Learn the basics of web technogies, product development and consulting.</p></li>
</ul>


<p><strong>Application procedure:</strong></p>

<p>Send application before May 20th 2012 to<a href="mailto:jobs@siyelo.com">jobs@siyelo.com</a> with a subject line of ”Social Media Marketing Internship application: <your name>”.</p>

<p>Please include;</p>

<ol>
<li><p>A brief explanation of who you are and how you would help us.</p></li>
<li><p>A copy of your CV</p></li>
<li><p>The time and dates you will be available to work at our office.</p></li>
</ol>

</div></div>
  
  


      </article>
    
    
      <article>
        
  <header>
    















<section><time class="timestamp" datetime="2011-12-30T12:41:00+02:00" pubdate data-updated="true">
    <span class='day'> 30</span>
    <span class='month'> Dec</span>
    <span class='year'> 2011</span>
  </time></section>
    
      <h1 class="entry-title"><a href="/intro-to-machine-learning-in-ruby">Intro to Machine Learning in Ruby</a></h1>
    
    <!--  -->
    <!--   <p class="meta"> &#8211;>
    <!--      -->
    <!--      | <a href="/intro-to-machine-learning-in-ruby#disqus_thread">Comments</a> &#8211;>
    <!--      -->
    <!--   </p> &#8211;>
    <!--  -->
  </header>


  <div class="body"><div class="inner"><p>Machine learning is branch of <strong>A</strong>rtificial <strong>I</strong>ntelligence (AI) concerned with design and development of algorithms that allow computers to learn. It&#8217;s a very broad subject so we will just focus on a simple example that uses statistical classification.</p>

<h3>Let&#8217;s build&#8230;</h3>

<p>In this tutorial we are going to build a simple news classification application that will parse and classify RSS/HTML articles from the <a href="http://www.timeslive.co.za/">Times Live</a> newspaper.</p>

<p>For the job, we will use <strong>nokogiri</strong> gem and 2 ruby standard libraries: <strong>open-uri</strong> and <strong>rss/2.0</strong>.</p>

<h3>RSS Parser</h3>

<p>To find sources of articles for processing,  we could build a complex search engine or we can simply use the RSS feeds the newspaper provides us with to look for and discover links. <strong>RssParser</strong> class does exactly that, you initialize it with a <a href="http://avusa.feedsportal.com/c/33051/f/534658/index.rss">feed url</a> and it gives you back the links to all the articles discovered in that feed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">RssParser</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:url</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@url</span> <span class="o">=</span> <span class="n">url</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">article_urls</span>
</span><span class='line'>    <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="kp">false</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">map</span><span class="p">{</span><span class="o">|</span><span class="n">item</span><span class="o">|</span> <span class="n">item</span><span class="o">.</span><span class="n">link</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>HTML Parser</h3>

<p>Having article links, we need to parse page content and extract meaningful parts from these pages. <strong>HtmlParser</strong> class can be initialized with a page url and DOM selector. In this example we will be using a CSS selector to extract the content from articles - <a href="http://getfirebug.com/">Firebug</a> and <a href="http://jquery.com/">jQuery</a> were used to find the selector for the text we are extracting from the article. In this class you will also notice <strong>clean_whitespace</strong> method which cleans the whitespace characters from the extracted text.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">HtmlParser</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:url</span><span class="p">,</span> <span class="ss">:selector</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@url</span>      <span class="o">=</span> <span class="n">url</span>
</span><span class='line'>    <span class="vi">@selector</span> <span class="o">=</span> <span class="n">selector</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">content</span>
</span><span class='line'>    <span class="n">doc</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span><span class='line'>    <span class="n">html_elements</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="n">html_elements</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">element</span><span class="o">|</span> <span class="n">clean_whitespace</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">clean_whitespace</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>      <span class="n">text</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/\s{2,}|\t|\n/</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Statistical Classifier</h3>

<p>We introduce a class that is responsible for classification of articles. It is initialized with a hash that consists of categories (keys) and training data (values).</p>

<p>Training data is used to discoverpotential relationships between articles and categories. This data should be carefully selected in order to give better classification results. It is created by determining the value for each word in the context of all words for that category (see the <strong>train_data()</strong>method).</p>

<p>In this example we are usingcontent ofWikipedia articles for <a href="http://en.wikipedia.org/wiki/Economy">economy</a>, <a href="http://en.wikipedia.org/wiki/Sport">sport</a> and <a href="http://en.wikipedia.org/wiki/Health">health</a> as training data for ourcategories.</p>

<p>When classifying articles we want to compare only meaningful words and ignore other wordsthat do not add any value for a certain category. We (partially) solve this problem using <a href="https://gist.github.com/1534053">stop words</a>.</p>

<p>Finally, the <strong>scores()</strong> method creates the scores for each category (per text) that we are testing.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Classifier</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:training_sets</span><span class="p">,</span> <span class="ss">:noise_words</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@training_sets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="n">filename</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">),</span> <span class="s1">&#39;stop_words.txt&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@noise_words</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:chomp</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">scores</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">downcase</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="sr">/[a-z]+/</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="n">training_sets</span><span class="o">.</span><span class="n">each_pair</span> <span class="k">do</span> <span class="o">|</span><span class="n">category</span><span class="p">,</span> <span class="n">word_weights</span><span class="o">|</span>
</span><span class='line'>      <span class="n">scores</span><span class="o">[</span><span class="n">category</span><span class="o">]</span> <span class="o">=</span> <span class="n">score</span><span class="p">(</span><span class="n">word_weights</span><span class="p">,</span> <span class="n">words</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">scores</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">train_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>    <span class="n">data</span><span class="o">.</span><span class="n">each_pair</span> <span class="k">do</span> <span class="o">|</span><span class="n">category</span><span class="p">,</span> <span class="n">text</span><span class="o">|</span>
</span><span class='line'>      <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">downcase</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="sr">/[a-z]+/</span><span class="p">)</span>
</span><span class='line'>      <span class="n">word_weights</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">words</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">word</span><span class="o">|</span> <span class="n">word_weights</span><span class="o">[</span><span class="n">word</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">unless</span> <span class="n">noise_words</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)}</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">ratio</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">words</span><span class="o">.</span><span class="n">length</span>
</span><span class='line'>      <span class="n">word_weights</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">key</span><span class="o">|</span> <span class="n">word_weights</span><span class="o">[</span><span class="n">key</span><span class="o">]</span> <span class="o">*=</span> <span class="n">ratio</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">training_sets</span><span class="o">[</span><span class="n">category</span><span class="o">]</span> <span class="o">=</span> <span class="n">word_weights</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">word_weights</span><span class="p">,</span> <span class="n">words</span><span class="p">)</span>
</span><span class='line'>      <span class="n">score</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">acc</span><span class="p">,</span> <span class="n">word</span><span class="o">|</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">word_weights</span><span class="o">[</span><span class="n">word</span><span class="o">]</span><span class="p">}</span>
</span><span class='line'>      <span class="mi">1000</span><span class="o">.</span><span class="mi">0</span> <span class="o">*</span> <span class="n">score</span> <span class="o">/</span> <span class="n">words</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Lets have a go</h3>

<p>Here is the script that runs the program:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;nokogiri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;rss/2.0&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># training data samples</span>
</span><span class='line'><span class="n">economy</span> <span class="o">=</span> <span class="no">HtmlParser</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;http://en.wikipedia.org/wiki/Economy&#39;</span><span class="p">,</span> <span class="s1">&#39;.mw-content-ltr&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">sport</span>   <span class="o">=</span> <span class="no">HtmlParser</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;http://en.wikipedia.org/wiki/Sport&#39;</span><span class="p">,</span> <span class="s1">&#39;.mw-content-ltr&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">health</span>  <span class="o">=</span> <span class="no">HtmlParser</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;http://en.wikipedia.org/wiki/Health&#39;</span><span class="p">,</span> <span class="s1">&#39;.mw-content-ltr&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">training_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">:economy</span> <span class="o">=&gt;</span> <span class="n">economy</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:sport</span> <span class="o">=&gt;</span> <span class="n">sport</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:health</span> <span class="o">=&gt;</span> <span class="n">health</span><span class="o">.</span><span class="n">content</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">classifier</span> <span class="o">=</span> <span class="no">Classifier</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">:economy</span> <span class="o">=&gt;</span> <span class="o">[]</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:sport</span> <span class="o">=&gt;</span> <span class="o">[]</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:health</span> <span class="o">=&gt;</span> <span class="o">[]</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">rss_parser</span> <span class="o">=</span> <span class="no">RssParser</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;http://avusa.feedsportal.com/c/33051/f/534658/index.rss&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">rss_parser</span><span class="o">.</span><span class="n">article_urls</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">article_url</span><span class="o">|</span>
</span><span class='line'>  <span class="n">article</span> <span class="o">=</span> <span class="no">HtmlParser</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">article_url</span><span class="p">,</span> <span class="s1">&#39;#article .area &gt; h3, #article .area &gt; p, #article &gt; h3&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">scores</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">scores</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span class='line'>  <span class="n">category_name</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">max_by</span><span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="n">v</span> <span class="p">}</span>
</span><span class='line'>  <span class="c1"># DEBUG info</span>
</span><span class='line'>  <span class="c1"># p &quot;category: #{category_name}, score: #{score}, scores: #{scores}, url: #{article_url}&quot;</span>
</span><span class='line'>  <span class="n">results</span><span class="o">[</span><span class="n">category_name</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="n">article_url</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">p</span> <span class="n">results</span>
</span></code></pre></td></tr></table></div></figure>


<p>Although our statistical classification algorithm is very simple, it can give remarkably good results provided the training data is good. For even better results you can try other classification algorithms like <a href="http://en.wikipedia.org/wiki/Bayesian_probability">Bayesian probability</a>  and <a href="http://en.wikipedia.org/wiki/Latent_semantic_analysis">Latent Semantic Analysis</a>.</p>

<p>If you are interested in amore indepth exampleof a news aggregator application - you can check <a href="https://github.com/siyelo/newsagg">newsagg</a> at Github. It&#8217;s a simple Sinatra application with a Redis datastore that we put together. It crawls, classifies and creates &#8216;clusters&#8217; of articles using statistical algorithms.</p>

<p>If you want to learn more about Machine Learning, checkout <a href="http://shop.oreilly.com/product/9780596529321.do">Programming Collective Intelligence</a> book - code examples written in Python and <a href="http://www.apress.com/9781430223511">Scripting Intelligence</a> - code examples written in Ruby.</p>
</div></div>
  
  


      </article>
    
    <div class="pagination">
      
        <a class="prev" href="/page/7/">Older</a>
      
      <a href="/blog/archives">Blog Archives</a>
      
      <a class="next" href="/page/5/">Newer</a>
      
    </div>
  </div>
  <aside class="sidebar">
    
      <section>
  <h1>About</h1>
  <ul id="about">
    <li>
      <p>Siyelo is a web development consultancy based in South Africa
      and Macedonia. We create bespoke web and mobile apps. Interested
      in working with us? <a href='mailto:info@siyelo.com'>Contact us</a>
      anytime.</p>
    </li>
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <p class="on-github"><a href="https://github.com/siyelo">@siyelo</a> on GitHub</p>
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'siyelo',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("siyelo", 3, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/siyelo" class="twitter-follow-button" data-show-count="false">Follow @siyelo</a>
  
</section>


    
  </aside>
</div>

  <footer role="contentinfo"><footer id="footer">
    <div class="wrapper">
      <ul class="clearfix">
        <li class="fourth">
          <a title="Email us - we want to hear from you" class="marker" href="mailto:info@siyelo.com">@</a>
          <span>Contact</span>
          <ul>
            <li>phone</li>
            <li>+27214612050</li>
            <li>email:</li>
            <li>
              <a title="Email us - we want to hear from you" href="mailto:info@siyelo.com">info@siyelo.com</a>
            </li>
          </ul>
        </li>
        <li class="fourth">
          <a title="Siyelo office in Cape Town" class="marker" target="_blank" href="http://g.co/maps/7xbpg">A</a>
          <span>Cape Town</span>
          <ul>
            <li>Suite #1, 4th Floor</li>
            <li>79 Roeland Street</li>
            <li>Cape Town, 8001</li>
            <li>South Africa</li>
          </ul>
        </li>
        <li class="fourth">
          <a title="Siyelo office in Skopje" class="marker" target="_blank" href="http://g.co/maps/ssf42">B</a>
          <span>Skopje</span>
          <ul>
            <li>Suite #5, 1st Floor</li>
            <li>Marx &amp; Engels 7</li>
            <li>Skopje</li>
            <li>Macedonia</li>
          </ul>
        </li>
        <li class="fourth social">
          <a title="Siyelo on Twitter" href="http://twitter.com/#!/siyelo"><img alt="Siyelo on Twitter" src="http://siyelo.com/images/icons/twitter.png"></a>
          <a title="Siyelo on Github" href="http://github.com/siyelo"><img alt="Siyelo on Github" src="http://siyelo.com/images/icons/github.png"></a>
          <a title="Siyelo blog RSS feed" href="http://blog.siyelo.com/rss.xml"><img alt="Siyelo blog RSS feed" src="http://siyelo.com/images/icons/rss.png"></a>
        </li>
      </ul>
      <aside>
        <a class="left back_to_top" href="#header">Back to top</a>
        <div class="right">
          <a title="Creative Commons - some rights reserved" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png"></a>
        </div>
      </aside>
    </div>
  </footer>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'siyelo';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
